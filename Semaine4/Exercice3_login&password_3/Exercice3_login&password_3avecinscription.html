<!DOCTYPE html>
<html lang="fr">
<html>
  <head>
    <meta charset="utf-8">
    <title> Login et Password </title>
  </head>
  <body>
  <script type="text/javascript">

  //Stockage des données dans des variables

  var questionIdentifiant = "Entrez votre identifiant";
  var questionMotDePasse = "Entrez votre mot de passe (plus de 4 caractères)";

  var identifiant = ["joe@gmail.com","toto@gmail.com","titi@gmail.com"];
  var motDePasse = ["12345","45678","12873"];

  var questionNouvelIdentifiant = "Entrez votre identifiant";
  var questionNouveauMdp = "Entrez votre mot de passe";

  var messageSucces = "Bienvenue";
  var messageErreur = "Identifiant ou mot de passe incorrect";
  var nombreTentative= 0;


//Creation d'une fonction qui sera appelée pour l'inscription si User est OK
  function inscription () {
    nouvelIdentifiant = prompt(questionNouvelIdentifiant);
    nouveauMotDePasse = prompt(questionNouveauMdp);
    verifierIdentifiant();
    verifierLongueur();
    console.log(identifiant);
    console.log(motDePasse);
  }

  //fonction pour verifier si nouvel identifiant contient un @
  function verifierIdentifiant () {
    if (nouvelIdentifiant.indexOf("@") != -1){
      identifiant.push(nouvelIdentifiant);
      return;
    }
    else {
      alert ("Votre identifiant ne contient pas de @, recommencez");
      inscription();
      }
  }

//fonction pour verifier si nouvel identifiant/MDP contient bien 4 caractères
  function verifierLongueur () {
    if (nouvelIdentifiant.length>4 && nouveauMotDePasse.length>4){
      motDePasse.push(nouveauMotDePasse);
      return;
    }
    else {
      alert ("Votre indentifiant et/ou mot de passe contient moins de 4 caractères, recommencez");
      inscription();
      }
  }

//fonction principale pour identification de user
  function identification () {
    //on incrémente tout de suite nombre de tentative comme ca =1
    nombreTentative++;
      //Pose question à User
      var reponsequestionIdentifiant = prompt(questionIdentifiant);
      console.log ("reponsequestionIdentifiant", reponsequestionIdentifiant );

      var reponsequestionMotDePasse = prompt(questionMotDePasse)
      console.log ("reponsequestionMotDePasse", reponsequestionMotDePasse);


      //SI l'identifiant contient le caractère @
      //SI l'identifiant ET le mot de passe contiennent plus de 4 caractères
      //SI les réponse de utilisateur pour MDP et identifiant sont
      // dans le tableau (INDEXOF), à la même postiton c'est bon
      for (i=0; i<identifiant.length; i++) {
              if (/@/.test(reponsequestionIdentifiant)&& reponsequestionIdentifiant.length>4 && reponsequestionMotDePasse.length>4
              && identifiant.indexOf(reponsequestionIdentifiant.toLowerCase())=== i&& motDePasse.indexOf(reponsequestionMotDePasse)=== i){
                alert (messageSucces);
                return;
              }
        }
      //Sinon, message d'erreur
      alert (messageErreur);

      //Si le nombre de tentatives est =4
        if (nombreTentative === 4) {
          //Demande a user si il veut s'inscrire
          var reponseInscription = confirm("Vous avez tenté 4 fois de vous connecter sans succès, voulez vous vous créer un compte ?");
          //Si réponse est "OK"
           if (reponseInscription === true){
             inscription(); // on lance la boucle pour inscription
           }
           //Si réponse est "annuler"
           else {
             alert("Merci de votre visite, à bientôt!")
            }
        }
        //Si nombre tentative <4, on recommence pour demander identif et MDP
        else {
          identification();
        }
      }

    </script>

  </body>
</html>
