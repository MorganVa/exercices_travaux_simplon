<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>JS Bin</title>
</head>
<body>
  <script type="text/javascript">

var choix = ["pierre", "feuille", "ciseau", "puit"];
var choixUtilisateur ;
var choixOrdi ;
var messageSucces ;
var messageErreur ;
var compteur = 0;
var scoreUtilisateur = 0;
var scoreOrdi = 0;
var utilisateurGagne;
var ordiGagne;

function utilisateur () {
  choixUtilisateur = prompt("Bonjour, nous allons jouer ensemble ! Choisissez : \n - Pierre \n - Feuille \n - Ciseau \n - Puit")
  console.log("choixUtilisateur "+choixUtilisateur);

  switch (choixUtilisateur.toLowerCase()){
    case "pierre" :
      alert("Vous avez choisi " + choixUtilisateur)
      break;

    case "feuille" :
      alert("Vous avez choisi " + choixUtilisateur)
      break;

    case "ciseau" :
      alert("Vous avez choisi " + choixUtilisateur)
      break;

    case "puit" :
      alert("Vous avez choisi " + choixUtilisateur)
      break;

    default :
      alert("Vous n'avez pas fait un bon choix, recommencez")
      break;
  }
}

function ordi () {
  choixOrdi = choix[Math.floor(Math.random()*(choix.length))];
  alert("L'ordinateur a tiré "+choixOrdi);
  console.log("choixOrdi "+choixOrdi)
  return choixOrdi;
}

function compare () {

   messageSucces = "vous gagnez cette manche.";
   messageErreur = "vous perdez cette manche.";

   if(choixUtilisateur=== choixOrdi) { // si égalité
     alert("Egalité, on rejoue ! ")
     jeu();
   }
   else if (choixUtilisateur === "pierre") { // si util choisit Pierre
     if (choixOrdi==="feuille") { // ordi choisit Feuille
       alert ("La feuille enveloppe la pierre, " + messageErreur)
       ordiGagne = true;
       score ();
     }
     else if (choixOrdi==="ciseau") { // ordi choisit Ciseau
       alert ("Le ciseau se casse sur la pierre, " + messageSucces)
       utilisateurGagne = true;
       score ();
     }
     else { // si util Puit
       alert("La pierre tombe dans le puit, " + messageErreur)
       ordiGagne = true;
       score ();
     }
   }

   else if (choixUtilisateur === "feuille") { // si util choisit Feuille
     if (choixOrdi === "Pierre") { // si ordi choisit Pierre
       alert("La feuille enveloppe la pierre, " + messageSucces)
       utilisateurGagne = true;
       score ();
     }
     else if (choixOrdi === "ciseau") { // si ordi choisit Ciseau
       alert ("Le ciseau coupe la feuille, " + messageErreur)
       ordiGagne = true;
       score ();
     }
     else { // si ordi choisit puit
       alert ("La feuille recouvre le puit, " + messageSucces)
       utilisateurGagne = true;
       score ();
     }
   }

   else if (choixUtilisateur === "ciseau") { // si util choisit Ciseau
      if (choixOrdi === "pierre") { // si ordi choisit Pierre
       alert("Le ciseau se casse sur la pierre, " + messageErreur)
       ordiGagne = true;
        score ();
     }
     else if (choixOrdi === "feuille") { // si ordi choisit Feuille
       alert ("Le ciseau coupe la feuille, " + messageSucces)
       utilisateurGagne = true;
       score ();
     }
     else { // si ordi choisit puit
       alert ("Le ciseau tombe dans le puit, " + messageErreur)
       ordiGagne = true;//TODO donne point a util ?
       score ();
     }
   }

    else if(choixUtilisateur ==="puit") { // si util choisit Puit
      if (choixOrdi === "pierre") { // si ordi choisit Pierre
       alert("La pierre tombe dans le puit, " + messageSucces)
       utilisateurGagne = true;
        score ();
     }
     else if (choixOrdi === "feuille") { // si ordi choisit Feuille
       alert ("La feuille recouvre le puit, " + messageErreur)
       ordiGagne = true;
       score ();
     }
     else { // si ordi choisit Ciseau
       alert ("Le ciseau tombe dans le puit, " + messageSucces)
       utilisateurGagne = true;
       score ();
     }
   }
  else {
    alert ("Erreur");
  }
 }

function score () {

  if (utilisateurGagne){
    scoreUtilisateur++;
    alert ("Vous avez "+ scoreUtilisateur+ " point(s) et l'ordinateur a "+scoreOrdi+ " point(s).")

  }
  else if (ordiGagne) {
    scoreOrdi++;
    alert ("Vous avez "+ scoreUtilisateur+ " point(s) et l'ordinateur a "+scoreOrdi+ " point(s).")
  }
  else {
    alert("erreur");
  }
}

function quiGagne () {


  if (scoreUtilisateur===3){
    alert("Vous avez gagné la partie !!! ");
    return;
  }
   else if (scoreOrdi ===3) {
      alert("L'ordinateur remporte la partie !!!");
      return;
    }
    else {
      jeu ();
    }
}

function jeu () {
  utilisateur();
  ordi();
  compare();
  quiGagne();
}





  </script>
</body>
</html>
